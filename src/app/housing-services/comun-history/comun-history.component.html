<ng-template #content>

  <div class="container-card col-12">

    <div class="card-box col-lg-6 col-md-12 col-sm-12 col-12">
      <div class="card">

        <div class="group">
          <mat-label class="group-label">Спосіб розрахунку
            <span class="accent" *ngIf="flatInfo.option_sendData === 1">Лічильник</span>
            <span class="accent" *ngIf="flatInfo.option_sendData === 2">Площа</span>
            <span class="accent" *ngIf="flatInfo.option_sendData === 3">Вартість</span>
          </mat-label>

          <div class="group-item-1">
            <div class="content">
              <label class="checkBox">
                <input id="send_counter" type="radio" [(ngModel)]="flatInfo.option_sendData" name="send_counter"
                  [value]=1>
                <div class="transition"></div>
              </label>
              <span class="about">Лічильник</span>
              <i></i>
            </div>

            <div class="content">
              <label class="checkBox">
                <input id="send_area" type="radio" [(ngModel)]="flatInfo.option_sendData" name="send_area" [value]=2>
                <div class="transition"></div>
              </label>
              <span class="about">Площа</span>
              <i></i>
            </div>

            <div class="content">
              <label class="checkBox">
                <input id="send_price" type="radio" [(ngModel)]="flatInfo.option_sendData" name="send_price" [value]=3>
                <div class="transition"></div>
              </label>
              <span class="about">Вартість</span>
              <i></i>
            </div>

          </div>

        </div>

        <div class="input-group" *ngIf="flatInfo.option_sendData === 1">
          <div class="item-group mt-2">
            <mat-form-field class="item-width-50" appearance="outline">
              <mat-label class="disabledNot">Попередні:</mat-label>
              <input class="disabledNot" matInput type="number" [(ngModel)]="flatInfo.comunal_before"
                name="comunal_before" (ngModelChange)="calculateConsumed()">
            </mat-form-field>

            <mat-form-field class="item-width-50" appearance="outline">
              <mat-label>Поточні:</mat-label>
              <input matInput type="number" [(ngModel)]="flatInfo.comunal_now" name="comunal_now"
                (ngModelChange)="calculatePay()" (ngModelChange)="calculateConsumed()">
            </mat-form-field>
          </div>

          <div class="item-group">
            <mat-form-field class="item-width-50" appearance="outline">
              <mat-label class="disabledNot">Спожито {{ selectedUnit }}:</mat-label>
              <input class="disabledNot" matInput type="number" [disabled]="disabledNot" [(ngModel)]="flatInfo.consumed"
                name="consumed" (ngModelChange)="calculatePay()">
            </mat-form-field>

            <mat-form-field class="item-width-50" appearance="outline">
              <mat-label>Тариф &#8372;/{{ selectedUnit }}:</mat-label>
              <input matInput type="number" [(ngModel)]="flatInfo.tariff" name="tariff"
                (ngModelChange)="calculatePay()">
            </mat-form-field>
          </div>

          <div class="item-group">
            <mat-form-field class="item-width-50 disabledNot" appearance="outline">
              <mat-label class="disabledNot">До сплати &#8372;:</mat-label>
              <input class="disabledNot" matInput type="number" [disabled]="disabledNot"
                [(ngModel)]="flatInfo.calc_howmuch_pay" (ngModelChange)="calculatePay()" name="calc_howmuch_pay">
            </mat-form-field>

            <mat-form-field class="item-width-50" appearance="outline">
              <mat-label>Сплатив &#8372;:</mat-label>
              <input matInput type="number" [(ngModel)]="flatInfo.howmuch_pay" name="howmuch_pay">
            </mat-form-field>
          </div>
        </div>

        <div class="input-group" *ngIf="flatInfo.option_sendData === 2">
          <div class="item-group mt-2">
            <mat-form-field class="item-width-50" appearance="outline">
              <mat-label class="disabledNot">Площа оселі м²</mat-label>
              <input class="disabledNot" name="area" matInput [disabled]="disabledNot" [(ngModel)]="area">
            </mat-form-field>

            <mat-form-field class="item-width-50" appearance="outline">
              <div class="list-label-1 list-label-2">Тип оселі</div>
              <mat-select class="disabledNot" name="area" [(ngModel)]="selectedOption" [disabled]="disabledNot">
                <mat-option [value]="1">Будинок</mat-option>
                <mat-option [value]="2">Квартира</mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <div class="item-group">
            <mat-form-field class="item-width-50 disabledNot" appearance="outline">
              <mat-label class="disabledNot">До сплати &#8372;:</mat-label>
              <input class="disabledNot" matInput type="number" [disabled]="disabledNot"
                [(ngModel)]="flatInfo.calc_howmuch_pay" (ngModelChange)="calculatePay()" name="calc_howmuch_pay">
            </mat-form-field>

            <mat-form-field class="item-width-50" appearance="outline">
              <mat-label>Тариф &#8372;/{{ selectedUnit }}:</mat-label>
              <input matInput type="number" [(ngModel)]="flatInfo.tariff" name="tariff"
                (ngModelChange)="calculatePay()">
            </mat-form-field>
          </div>

          <div class="item-group">
            <mat-form-field class="item-select" appearance="outline">
              <mat-label>Сплатив &#8372;:</mat-label>
              <input matInput type="number" [(ngModel)]="flatInfo.howmuch_pay" name="howmuch_pay">
            </mat-form-field>
          </div>

        </div>

        <div class="input-group" *ngIf="flatInfo.option_sendData === 3">
          <mat-form-field class="item-select mb-2" appearance="outline">
            <mat-label>Тариф &#8372;/{{ selectedUnit }}:</mat-label>
            <input matInput type="number" [(ngModel)]="flatInfo.tariff" name="tariff" (ngModelChange)="calculatePay()">
          </mat-form-field>

          <mat-form-field class="item-select mb-2 disabledNot" appearance="outline">
            <mat-label class="disabledNot">До сплати &#8372;:</mat-label>
            <input class="disabledNot" matInput type="number" [disabled]="disabledNot"
              [(ngModel)]="flatInfo.calc_howmuch_pay" (ngModelChange)="calculatePay()" name="calc_howmuch_pay">
          </mat-form-field>

          <mat-form-field class="item-select mb-2" appearance="outline">
            <mat-label>Сплатив &#8372;:</mat-label>
            <input matInput type="number" [(ngModel)]="flatInfo.howmuch_pay" name="howmuch_pay">
          </mat-form-field>

        </div>

        <div class="group">
          <div class="text-1">Останній вносив показники</div>
          <div class="text-1">користувач з ID <span class="accent"> {{flatInfo.user_id}}</span></div>
        </div>

        <div class="form-floating p-1">
          <textarea #textArea class="form-control scrollable-textarea" id="floatingTextarea"
            [(ngModel)]="flatInfo.about_pay" name="about_pay" (input)="onInput()"></textarea>
          <label for="floatingTextarea">
            <p>Коментар про запис:</p>
          </label>
        </div>

        <div class="btn-group">
          <button class="btn" matTooltip="ЗБЕРЕГТИ" (click)="saveInfo()"><i
              class="icon fa-regular fa-circle-check"></i></button>
          <button class="btn" matTooltip="ОЧИСТИТИ" (click)="clearInfo()"><i
              class="icon fa-solid fa-eraser"></i></button>
          <button class="btn" matTooltip="Копіювати" (click)="copy()"><i class="fa-regular fa-copy"></i></button>
          <button class="btn" matTooltip="Вставити" (click)="paste()"><i class="fa-solid fa-paste"></i></button>
        </div>


      </div>

    </div>

    <div [@cardAnimation1] class="card-box col-lg-6 col-md-12 col-sm-12 col-12">
      <div class="card">

        <div *ngIf="!flatInfo.option_sendData">
          <div class="p-2">
            <p class="about"><strong class="accent">Лічильник</strong> - якщо обрати цей спосіб розрахунку то розрахунок
              буде мати
              такий вигляд:</p>
          </div>

          <div class="p-2">
            <p class="about"><strong class="accent">Спожито</strong> - формула розрахунку:</p>
            <div class="formula">("поточний" - "попередній") * тариф</div>
          </div>

          <div class="p-2">
            <p class="about"><strong class="accent">До сплати</strong> - формула розрахунку:</p>
            <div class="formula">(тариф * спожито)</div>
          </div>

          <div class="p-2">
            <p class="about"><strong class="accent">Сплатив</strong> - для внесення суми яку була по факту оплачена</p>
          </div>

          <div class="p-2">
            <p class="about"><strong class="accent">Коментар про запис</strong> - для внесення коментарів про створений
              підрахунок</p>
          </div>

          <div class="p-2">
            <p class="description">Всі дані записуються в окремі місяці, поточний показник по лічильнику записується як
              попередній в наступний
              місяць, тариф також записується в наступний місяць, ці дані можна корегувати в кожному місяці</p>
          </div>

        </div>

        <div *ngIf="flatInfo.option_sendData === 1">
          <div class="p-2">
            <p class="about"><strong class="accent">Лічильник</strong> - якщо обрати цей спосіб розрахунку то розрахунок
              буде мати
              такий вигляд:</p>
          </div>

          <div class="p-2">
            <p class="about"><strong class="accent">Спожито</strong> - формула розрахунку:</p>
            <div class="formula">("поточний" - "попередній") * тариф</div>
          </div>

          <div class="p-2">
            <p class="about"><strong class="accent">До сплати</strong> - формула розрахунку:</p>
            <div class="formula">(тариф * спожито)</div>
          </div>

          <div class="p-2">
            <p class="about"><strong class="accent">Сплатив</strong> - для внесення суми яку була по факту оплачена</p>
          </div>

          <div class="p-2">
            <p class="about"><strong class="accent">Коментар про запис</strong> - для внесення коментарів про створений
              підрахунок</p>
          </div>

          <div class="p-2">
            <p class="description">Всі дані записуються в окремі місяці, поточний показник по лічильнику записується як
              попередній в наступний
              місяць, тариф також записується в наступний місяць, ці дані можна корегувати в кожному місяці</p>
          </div>

        </div>

        <div class="box" *ngIf="flatInfo.option_sendData === 2">

          <div class="p-2">
            <p class="about"><strong class="accent">Площа</strong> - якщо обрати цей спосіб розрахунку то розрахунок
              буде мати такий вигляд:</p>
          </div>

          <div class="p-2">
            <p class="about"><strong class="accent">До сплати</strong> - формула розрахунку:</p>
              <div class="formula">(тариф * площу м2)</div>
          </div>

          <div class="p-2">
            <p class="about"><strong class="accent">Сплатив</strong> - для внесення суми яку була по факту оплачена</p>
          </div>

          <div class="p-2">
            <p class="about"><strong class="accent">Коментар про запис</strong> - для внесення коментарів про створений
              підрахунок</p>
          </div>

          <div class="p-2">
            <p class="description">Всі дані записуються в окремі місяці, поточний показник по лічильнику записується як
              попередній в наступний
              місяць, тариф також записується в наступний місяць, ці дані можна корегувати в кожному місяці</p>
          </div>

        </div>

        <div class="box" *ngIf="flatInfo.option_sendData === 3">
          <div class="p-2">
            <p class="about"><strong class="accent">Вартість</strong> - якщо обрати цей спосіб розрахунку то розрахунок
              буде мати такий вигляд:</p>
          </div>

          <div class="p-2">
            <p class="about"><strong class="accent">До сплати</strong> - оплата по фіксованому тарифу:</p>
          </div>

          <div class="p-2">
            <p class="about"><strong class="accent">Сплатив</strong> - для внесення суми яку була по факту оплачена</p>
          </div>

          <div class="p-2">
            <p class="about"><strong class="accent">Коментар про запис</strong> - для внесення коментарів про створений
              підрахунок</p>
          </div>

          <div class="p-2">
            <p class="description">Всі дані записуються в окремі місяці, поточний показник по лічильнику записується як
              попередній в наступний
              місяць, тариф також записується в наступний місяць, ці дані можна корегувати в кожному місяці</p>
          </div>

        </div>

      </div>
    </div>

  </div>

</ng-template>

<ng-container *ngIf="loading; else content">
  <app-loader></app-loader>
</ng-container>


<div *ngIf="statusMessage" class="status-message">
  <div class="status-message-text">Дані за послугу <br> <span class="accent">"{{selectedComun}}" {{ selectedMonth }} {{
      selectedYear }}</span> <br> {{ statusMessage }}</div>
  <img class="status-message-logo" src="{{path_logo}}" alt="logo">
  <div class="status-message-name">Discussio</div>
</div>
