<ng-container *ngIf="loading; else content">
  <app-loader></app-loader>
</ng-container>

<ng-template #content>
  <div class="table-content">
    <div class="sticky-top p-2">
      <div class="t-lar t-c bold">Графік за рік</div>
      <div class="app"><app-select-year></app-select-year></div>
      <div class="switch-container jc-fs p-2">

        <div class="switch-btn-group">
          <button class="btn" (click)="option_stat = 3" [ngClass]="{ 'active': option_stat === 3}">
            <i class="fa-solid fa-cookie-bite"></i>
            <div class="t-min dark bold">Спожито</div>
          </button>
        </div>

        <div class="switch-btn-group">
          <button class="btn" (click)="option_stat = 2" [ngClass]="{ 'active': option_stat === 2}">
            <i class="fa-solid fa-cash-register"></i>
            <div class="t-min dark bold">Нараховано</div>
          </button>
        </div>

        <div class="switch-btn-group">
          <button class="btn" (click)="option_stat = 1" [ngClass]="{ 'active': option_stat === 1}">
            <i class="fa-solid fa-check-to-slot"></i>
            <div class="t-min dark bold">Сплачено</div>
          </button>
        </div>

        <div class="switch-btn-group">
          <button class="btn" [routerLinkActive]="'active'" [routerLink]="'/communal/stat-year'">
            <i class="fa-solid fa-table-list"></i>
            <div class="t-min dark bold">Підрахунки</div>
          </button>
        </div>
      </div>
    </div>
    <section class="table-info">
      <div class="container-box w-100 mt-2" *ngIf="!noData">
        <div class="box" *ngIf="option_stat === 2">
          <div class="progress-container">
            <div class="progress m-1" [@columnAnimation] *ngFor="let season of dataForGraph" role="progressbar">
              <div class="month-label"><span class="num-label">{{season.total_calc_howmuch_pay?.toFixed(1)
                  }}₴</span>{{
                season.comunal_name }}</div>
              <div class="progress-bar"
                [ngStyle]="{ 'width': (season.total_calc_howmuch_pay / maxPaymentsValue) * 100 + '%' }">

              </div>

            </div>
          </div>
        </div>

        <div class="box" *ngIf="option_stat === 1">
          <div class="progress-container">
            <div class="progress m-1" [@columnAnimation] *ngFor="let season of dataForGraph" role="progressbar">
              <div class="month-label"><span class="num-label bold">{{season.total_howmuch_pay?.toFixed(1)
                  }}₴</span>{{
                season.comunal_name }}</div>
              <div class="progress-bar"
                [ngStyle]="{ 'width': (season.total_howmuch_pay / maxNeedPayValue) * 100 + '%' }">

              </div>

            </div>
          </div>
        </div>

        <div class="box" *ngIf="option_stat === 3">
          <div class="progress-container">
            <div class="progress m-1" [@columnAnimation] *ngFor="let season of dataForGraph" role="progressbar">
              <div class="month-label"><span class="num-label">{{season.total_consumed?.toFixed(1) }}</span>{{
                season.comunal_name }}</div>
              <div class="progress-bar"
                [ngStyle]="{ 'width': (season.total_consumed / maxConsumptionsValue) * 100 + '%' }"
                *ngIf="season.total_consumed">
              </div>

            </div>
          </div>
        </div>
      </div>
      <div [@left3] class="table-container" *ngIf="noData">
        <h4 class="p-2 mt-3">Статистики за цей час немає...</h4>
      </div>
    </section>
  </div>
</ng-template>
